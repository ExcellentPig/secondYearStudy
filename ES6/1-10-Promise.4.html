<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Promise</title>
		<script src="../js/jquery-3.2.1.js"></script>
	</head>
	<body>
		<!--
		
			Promise------承诺
			
			异步:
				操作之间没关系
				同时进行多个操作
				
				代码更复杂
			同步:
				同时只能做一件事
				
				代码简单
				
			Promise---消除异步操作
				用同步一样的方式来书写异步
				
				
			----------------------------------------------
				
			Promise.all
			Promise.race  竞速
			
			
			谁快先用谁
			Promise.race([
				$.ajax({url:'http://a2.taobao.com/data/users'}),
				$.ajax({url:'http://a5.taobao.com/data/users'}),
				$.ajax({url:'http://a12.taobao.com/data/users'}),
				$.ajax({url:'http://a3.taobao.com/data/users'}),
			])
		-->
		<script>
			let p1 = new Promise(function(resolve, reject) {
				//异步代码
				//resolve--成功  reject--失败

				$.ajax({
					url: '../data/arr.txt',
					dataType: 'json',
					success(arr) {
						resolve(arr);
					},
					error(err) {
						reject(err);
					}
				})
			})
			let p2 = new Promise(function(resolve, reject) {
				//异步代码
				//resolve--成功  reject--失败

				$.ajax({
					url: '../data/json.txt',
					dataType: 'json',
					success(arr) {
						resolve(arr);
					},
					error(err) {
						reject(err);
					}
				})
			})
			Promise.all([
				p1,p2
			]).then(function(arr){
				let [res1,res2] = arr;
				console.log(res1);
				console.log(res2);
				console.log('all resolve');
				console.log(arr);
				
			},function(){
				console.log('all reject');
			})
		</script>
	</body>
</html>
